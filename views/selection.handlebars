{{!-- Todo have user put in name and then have a "save" button for the current selection, send to Mongo with information --}}

<form>
    <label for="Username">Pull up your account (case sensitive)</label>
    <div class="input-group mb-3">
        <input type="text" name="Username" class="form-control" placeholder="Username" aria-label="Username"
            aria-describedby="basic-addon1">
        <div class="input-group-append">
            <button class="btn btn-outline-secondary" type="button">Submit</button>
        </div>
    </div>
</form>

<div class="row">
    <div class="col-md-6">
        <ul>
            {{#each types}}
            <div class="form-check">
                {{#if selected}}
                <input class="form-check-input" type="checkbox" data-link={{link}} data-title="{{title}}" id={{link}}
                    checked>
                <label class="form-check-label" for={{link}}>
                    {{title}}
                </label>
                {{else}}
                <input class="form-check-input" type="checkbox" data-link={{link}} data-title="{{title}}" id={{link}}>
                <label class="form-check-label" for={{link}}>
                    {{title}}
                </label>
                {{/if}}
            </div>
            {{/each}}
        </ul>
    </div>
    <div class="col-md-6">
        <div class="selectionBox">
            Current Selection
            <div class="display"></div>
        </div>
    </div>
</div>

<script>

    

    let selection = JSON.parse(localStorage.getItem("selection"));
    if (selection === null) {
        selection = [];
    }
    let titles = JSON.parse(localStorage.getItem("titles"));
    if (titles === null) {
        titles = [];
    }

    $(".display").text(titles)

    $(".form-check-input").on("change", function () {

        let link = $(this).data("link");
        let title = $(this).data("title");

        if (selection.includes(link)) {
            for (var i = 0; i < selection.length; i++) {
                if (selection[i] === link) {
                    selection.splice(i, 1);
                }
            }
        } else {
            selection.push(link);
        }
        if (titles.includes(title)) {
            for (var i = 0; i < titles.length; i++) {
                if (titles[i] === title) {
                    titles.splice(i, 1);
                }
            }
        } else {
            titles.push(title);
        }

        $(".display").text(titles)


        localStorage.setItem("titles", JSON.stringify(titles));
        localStorage.setItem("selection", JSON.stringify(selection));
    })
</script>